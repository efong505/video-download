<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subscribe to Newsletter</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .subscribe-container {
            max-width: 600px;
            margin: 50px auto;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .success-message {
            display: none;
            padding: 20px;
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 5px;
            color: #155724;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="subscribe-container">
            <h2 class="text-center mb-4">ðŸ“§ Subscribe to Our Newsletter</h2>
            <p class="text-center text-muted">Stay informed with weekly updates on articles, videos, election coverage, and prayer requests.</p>
            
            <div id="successMessage" class="success-message mb-3">
                <h5>âœ“ Almost there!</h5>
                <p>We've sent a confirmation email to your inbox. Please click the link in the email to confirm your subscription.</p>
            </div>
            
            <form id="subscribeForm">
                <div class="mb-3">
                    <label class="form-label">Email Address *</label>
                    <input type="email" id="email" class="form-control" required>
                </div>
                
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label class="form-label">First Name</label>
                        <input type="text" id="firstName" class="form-control">
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Last Name</label>
                        <input type="text" id="lastName" class="form-control">
                    </div>
                </div>
                
                <div class="mb-3">
                    <label class="form-label">I'm interested in:</label>
                    <div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="int_articles" value="articles" checked>
                            <label class="form-check-label" for="int_articles">Articles & News</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="int_videos" value="videos" checked>
                            <label class="form-check-label" for="int_videos">Videos & Sermons</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="int_election" value="election" checked>
                            <label class="form-check-label" for="int_election">Election Updates</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="int_prayer" value="prayer" checked>
                            <label class="form-check-label" for="int_prayer">Prayer Requests</label>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="btn btn-primary w-100">Subscribe</button>
                
                <p class="text-center text-muted mt-3" style="font-size: 0.85em;">
                    By subscribing, you agree to receive emails from Christian Conservatives Today. 
                    You can unsubscribe at any time.
                </p>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const API_URL = 'YOUR-API-GATEWAY-URL/email-subscribers';

        document.getElementById('subscribeForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = document.getElementById('email').value;
            const firstName = document.getElementById('firstName').value;
            const lastName = document.getElementById('lastName').value;
            
            const interests = [];
            if (document.getElementById('int_articles').checked) interests.push('articles');
            if (document.getElementById('int_videos').checked) interests.push('videos');
            if (document.getElementById('int_election').checked) interests.push('election');
            if (document.getElementById('int_prayer').checked) interests.push('prayer');
            
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        action: 'subscribe',
                        email: email,
                        first_name: firstName,
                        last_name: lastName,
                        interests: interests,
                        source: 'website'
                    })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    document.getElementById('subscribeForm').style.display = 'none';
                    document.getElementById('successMessage').style.display = 'block';
                } else {
                    alert(data.error || 'Failed to subscribe');
                }
            } catch (error) {
                console.error('Error subscribing:', error);
                alert('Failed to subscribe. Please try again.');
            }
        });
    </script>
</body>
</html>
